<!--
This document is a testing environment for javascript function development.

Instructions to include parsing functions in ReactJS Front-End:

1. Copy/Paste the forge-sha256 folder into an appropriate location to get the hashing function source code.
2. Copy/Paste the magParser(), uinParser(), and rfidParser() functions into the ReactJS code

-->
<html>
<head>
	<title> Card ID Parsing Function </title>
	
	<!-- Using Forge's SHA-256 Hash Implementation https://github.com/brillout/forge-sha256 -->
	<script src='forge-sha256/build/forge-sha256.min.js'></script>
	
</head>
<body>

<script>

function runMag(){
	var rawData = document.getElementById('magStripeInput').value //.split(/\r?\n/);
	
	document.getElementById('magStripeOutput').value = magParser(rawData);
}


function magParser(rawData){

	var regexFull = /[%]([0-9]{16})\?([;+]\1\?([+]\1\?)?)?/;

	var result = regexFull.test(rawData);

	if(result){	
		//Grab string of numbers, send through hash
		var cardID = regexFull.exec(rawData)[1]; //Get first capturing group from Regex
		return forge_sha256(cardID);	//Hash card ID
	}
	else{
		return "Regected";
	}

	return "end of function";
}

function runUin(){
	var rawData = document.getElementById('uinInput').value // .split(/\r?\n/);
	
	document.getElementById('uinOutput').value = uinParser(rawData);
}

function uinParser(rawData){

	var regexFull = /^[0-9]{3}00[0-9]{4}$/

	var result = regexFull.test(rawData);

	if(result){
		//No need to hash UIN
		return rawData;
	}
	else{
		return "Regected";
	}

	return "end of function";
}

function runRfid(){
	var rawData = document.getElementById('rfidInput').value // .split(/\r?\n/);
	
	document.getElementById('rfidOutput').value = rfidParser(rawData);
}

function rfidParser(rawData){

	var regexFull = / / //Incomplete. Need dummy data

	var result = regexFull.test(rawData);

	if(result){
		var cardID = regexFull.exec(rawData)[1];	//Get first capturing group from Regex
		return forge_sha256(cardID);	//Hash card ID
	}

	else{
		return "Regected";
	}

	return "end of function";
}


</script>


<h1> Howdy! Enter raw card data, UINs, or RFID raw data in the boxes. </h1>
<p> Output for Magstripe and RFID data is hashed using Forge's SHA-256 implementation. </p>


<!-- Magstripe -->
<div style="width: 100%; overflow: hidden;">
    <div style="width: 50%; float: left;">
    	Magstripe Raw Data<br>
    	<textarea rows="2" cols="30" id="magStripeInput">Write here</textarea>
    </div>
    <div style="width: 50%; float: right;">
    	Magstripe Output<br>
    	<textarea rows="2" cols="30" id="magStripeOutput"> </textarea>
    </div>
<button style=" top:50%; left:50%;" id="magStripeButton" onclick="runMag()"> Parse </button> <br>
</div>

<br>

<!-- UIN -->
<div style="width: 100%; overflow: hidden;">
    <div style="width: 50%; float: left;">
    	UIN<br>
    	<textarea rows="2" cols="30" id="uinInput">Write here</textarea>
    </div>
    <div style="width: 50%; float: right;">
    	UIN Output<br>
    	<textarea rows="2" cols="30" id="uinOutput"> </textarea>
    </div>
<button style=" top:50%; left:50%;" id="uinButton" onclick="runUin()"> Parse </button> <br>
</div>

<br>


<!-- RFID -->
<div style="width: 100%; overflow: hidden;">
    <div style="width: 50%; float: left;">
    	RFID<br>
    	<textarea rows="2" cols="30" id="rfidInput">Write here</textarea>
    </div>
    <div style="width: 50%; float: right;">
    	UIN Output<br>
    	<textarea rows="2" cols="30" id="rfidOutput"> </textarea>
    </div>
<button style=" top:50%; left:50%;" id="rfidButton" onclick="runRfid()"> Parse </button> <br>
</div>

<br>


</body>
</html>